(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{a55b:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Center",[r("router-link",{staticClass:"d-inline-block my-2 no-decoration",attrs:{to:"/"}},[r("span",{staticClass:"logo iconfont icon-steemconnect"}),r("h4",{staticClass:"m-0"},[e._v("steemconnect")])]),r("div",{staticClass:"width-full p-4 mb-2"},[r("form",{staticClass:"text-left",attrs:{method:"post"},on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[r("label",{attrs:{for:"username"}},[e._v("Steem username")]),e.dirty.username&&e.errors.username?r("div",{staticClass:"error mb-2"},[e._v("\n        "+e._s(e.errors.username)+"\n      ")]):e._e(),r("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.username,expression:"username",modifiers:{trim:!0}}],staticClass:"form-select input-lg input-block mb-2",attrs:{id:"username",autocorrect:"off",autocapitalize:"none",autocomplete:"username"},on:{blur:function(t){return e.handleBlur("username")},change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.username=t.target.multiple?r:r[0]}}},e._l(Object.keys(e.keychain),function(t){return r("option",{key:t,domProps:{value:t}},[e._v("\n          "+e._s(t)+"\n        ")])}),0),r("label",{attrs:{for:"password"}},[e._v("\n        Keychain password\n        "),r("span",{staticClass:"tooltipped tooltipped-n tooltipped-multiline",attrs:{"aria-label":e.TOOLTIP_LOGIN_ENCRYPTION_KEY}},[r("span",{staticClass:"iconfont icon-info"})])]),e.dirty.key&&e.errors.key?r("div",{staticClass:"error mb-2"},[e._v("\n        "+e._s(e.errors.key)+"\n      ")]):e._e(),r("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.key,expression:"key",modifiers:{trim:!0}}],staticClass:"form-control input-lg input-block mb-2",class:{"mb-4":!e.error},attrs:{id:"password",type:"password",autocorrect:"off",autocapitalize:"none",autocomplete:"current-password"},domProps:{value:e.key},on:{blur:[function(t){return e.handleBlur("key")},function(t){return e.$forceUpdate()}],input:function(t){t.target.composing||(e.key=t.target.value.trim())}}}),e.error?r("div",{staticClass:"error mb-4"},[e._v(e._s(e.error))]):e._e(),r("button",{staticClass:"btn btn-large btn-blue input-block mb-2",attrs:{disabled:e.submitDisabled||e.isLoading,type:"submit"}},[e._v("\n        Log in\n      ")]),r("router-link",{staticClass:"btn btn-large input-block text-center mb-2",attrs:{to:{name:"import",query:{redirect:e.redirect,authority:e.authority}}}},[e._v("\n        Import account\n      ")])],1)]),r("Footer")],1)},o=[],s=(r("6b54"),r("768b")),i=r("a4bb"),a=r.n(i),u=r("cebc"),c=r("2f62"),l=r("66b3"),m=r.n(l),d=r("cbd4"),p=r("a2b6"),b=r("40c1"),f=r("c9c1"),h={data:function(){return{keychain:{},dirty:{username:!1,key:!1},error:"",isLoading:!1,redirect:this.$route.query.redirect,authority:Object(b["b"])(this.$route.query.authority),TOOLTIP_LOGIN_ENCRYPTION_KEY:f["d"]}},computed:{username:{get:function(){return this.$store.state.persistentForms.login.username},set:function(e){this.$store.commit("saveLoginUsername",e)}},key:{get:function(){return this.$store.state.persistentForms.login.key},set:function(e){this.$store.commit("saveLoginKey",e)}},submitDisabled:function(){return!!this.errors.username||!!this.errors.key},errors:function(){var e={},t=this.username,r=this.key;return t||(e.username="Username is required."),r||(e.key="Keychain password is required."),e}},created:function(){this.loadKeychain()},methods:Object(u["a"])({},Object(c["b"])(["login"]),{resetForm:function(){this.dirty={username:!1,key:!1},this.username="",this.key=""},loadKeychain:function(){this.keychain=Object(d["b"])();var e=a()(this.keychain);if(e.length>0){var t=Object(s["a"])(e,1);this.username=t[0]}},handleBlur:function(e){this.dirty[e]=!0},submitForm:function(){var e=this,t=this.authority,r=this.keychain[this.username];this.isLoading=!0,m.a.decrypt({data:new m.a.Buffer(r,"hex"),key:new m.a.Buffer(this.key)},function(r,n){if(r)return e.isLoading=!1,e.error=f["b"],void console.log("err",r);var o=Object(p["l"])(n.toString());if(t&&!o[t])return e.isLoading=!1,void(e.error="You need to import your account using your password or ".concat(t,' key to do this request. Click "Import account" button to proceed.'));e.login({username:e.username,keys:o}).then(function(){var t=e.$route.query.redirect;e.$router.push(t||"/"),e.isLoading=!1,e.error="",e.resetForm()}).catch(function(t){console.log("Login failed",t),e.isLoading=!1,e.error=f["a"]})})}})},y=h,v=r("2877"),k=Object(v["a"])(y,n,o,!1,null,null,null);t["default"]=k.exports}}]);
//# sourceMappingURL=login.b43d4bd7.js.map