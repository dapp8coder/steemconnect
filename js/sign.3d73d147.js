(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["sign"],{"1c4f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Header",{attrs:{title:t.title}}),t.parsed&&t.uriIsValid?a("div",{staticClass:"p-4 after-header"},[a("div",{staticClass:"container-sm mx-auto"},[!t.isWeb||t.failed||t.transactionId?t._e():a("OpenExternal",{staticClass:"hide-sm",attrs:{withChrome:!0,uri:t.uri}}),!t.loading&&t.failed?a("Error",{attrs:{error:t.error}}):t._e(),!t.loading&&t.transactionId?a("Confirmation",{attrs:{id:t.transactionId}}):t._e(),t.failed||t.transactionId?t._e():a("div",[t._l(t.parsed.tx.operations,function(t,e){return a("Operation",{key:e,attrs:{operation:t}})}),t.parsed.params.callback?a("div",{staticClass:"flash flash-warn mb-4"},[t._v("\n          You are going to get redirected to\n          "),a("span",{staticClass:"link-color"},[t._v(t._s(t._f("parseUrl")(t.parsed.params.callback)))]),t._v(".\n        ")]):t._e(),t.username&&!1===t.hasRequiredKey?a("div",{staticClass:"flash flash-warn mb-4"},[t._v("\n          This transaction requires your "),a("b",[t._v(t._s(t.authority))]),t._v(" key.\n        ")]):t._e(),a("div",{staticClass:"mb-4"},[t.username&&!1!==t.hasRequiredKey?a("button",{staticClass:"btn btn-large btn-success mr-2 mb-2",attrs:{type:"submit",disabled:t.loading},on:{click:t.handleSubmit}},[t._v("\n            "+t._s(t.parsed.params.no_broadcast?"Sign":"Approve")+"\n          ")]):a("router-link",{staticClass:"btn btn-large btn-blue mr-2 mb-2",attrs:{to:{name:"login",query:{redirect:this.$route.fullPath,authority:t.authority}}}},[t._v("\n            Continue\n          ")]),a("button",{staticClass:"btn btn-large mb-2",on:{click:t.handleReject}},[t._v("\n            Cancel\n          ")])],1)],2)],1)]):a("div",{staticClass:"p-4 after-header"},[a("div",{staticClass:"container-sm mx-auto flash flash-error mb-4"},[t._v("\n      Oops, something went wrong. The signing URL provided is invalid.\n    ")])])],1)},r=[],i=a("768b"),n=(a("96cf"),a("3b8d")),o=a("cebc"),c=(a("ac6a"),a("d62a")),u=a("2f62"),l=a("451e"),d=a("40c1"),h=a("a2b6"),b={data:function(){return{parsed:null,uriIsValid:!0,loading:!1,transactionId:"",failed:!1,error:!1,isWeb:Object(h["k"])(),uri:"steem://sign/".concat(this.$route.params.pathMatch).concat(Object(h["c"])(this.$route)),requestId:this.$route.query[h["a"]],authority:Object(d["b"])(this.$route.query.authority),hasRequiredKey:null}},computed:{title:function(){var t="Confirm transaction";return this.authority&&(t+=" (".concat(this.authority,")")),t},username:function(){return this.$store.state.auth.username},config:function(){return{vestsToSP:Object(h["g"])(this.$store.state.settings.properties)}}},mounted:function(){this.parseUri(this.uri),!this.authority&&this.parsed&&this.parsed.tx&&(this.authority=Object(h["f"])(this.parsed.tx),this.hasRequiredKey=!(!this.$store.state.auth.username||!this.$store.state.auth.keys[this.authority]))},methods:Object(o["a"])({},Object(u["b"])(["sign","broadcast"]),{parseUri:function(t){var e;try{e=c["decode"](t)}catch(a){e=Object(h["m"])(t),e||(this.uriIsValid=!1)}this.parsed=Object(h["n"])(e,this.config)},handleSubmit:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,a,s,r,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e=null,a=null,s=null,r=null,t.prev=5,t.next=8,Object(l["b"])(this.parsed,this.$store.state.auth.username);case 8:return a=t.sent,t.next=11,this.sign({tx:a,authority:this.authority});case 11:s=t.sent,n=Object(i["a"])(s.signatures,1),e=n[0],t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),console.error("Failed to resolve and sign transaction",t.t0);case 19:if(e){t.next=24;break}return this.transactionId="",this.failed=!0,this.loading=!1,t.abrupt("return");case 24:if(this.parsed.params.no_broadcast){t.next=41;break}return t.prev=25,t.next=28,this.broadcast(s);case 28:r=t.sent,this.transactionId=r.id,this.failed=!1,this.requestId&&Object(h["o"])(this.requestId,null,{result:r}),t.next=41;break;case 34:t.prev=34,t.t1=t["catch"](25),this.error=t.t1,console.error("Failed to broadcast transaction",t.t1),this.transactionId="",this.failed=!0,this.requestId&&Object(h["o"])(this.requestId,t.t1,null);case 41:r&&this.parsed.params.callback&&Object(h["k"])()?window.location=c["resolveCallback"](this.parsed.params.callback,{sig:e,id:r.id||void 0,block:r.block_num||void 0,txn:r.txn_num||void 0}):this.loading=!1;case 42:case"end":return t.stop()}},t,this,[[5,16],[25,34]])}));function e(){return t.apply(this,arguments)}return e}(),handleReject:function(){this.requestId&&Object(h["o"])(this.requestId,"Request rejected",null),Object(h["h"])()||this.$router.push("/")}})},p=b,m=a("2877"),f=Object(m["a"])(p,s,r,!1,null,null,null);e["default"]=f.exports}}]);
//# sourceMappingURL=sign.3d73d147.js.map