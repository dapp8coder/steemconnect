{"version":3,"sources":["webpack:///./src/views/Revoke.vue?ed83","webpack:///src/views/Revoke.vue","webpack:///./src/views/Revoke.vue?d84d","webpack:///./src/views/Revoke.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","title","staticClass","hasAuthority","isWeb","failed","transactionId","uri","_e","on","submit","$event","preventDefault","handleSubmit","username","size","_v","_s","authority","account","name","hasRequiredKey","type","disabled","loading","to","query","redirect","$route","fullPath","click","handleReject","callback","href","_f","error","id","staticRenderFns","Revokevue_type_script_lang_js_","data","Object","utils","params","auth","redirect_uri","concat","computed","$store","state","auths","account_auths","map","indexOf","keys","active","methods","objectSpread","vuex_esm","_this","memo_key","json_metadata","JSON","parse","stringify_default","forEach","accountAuth","i","splice","updateAccount","then","confirmation","loadAccount","$router","push","window","location","catch","err","console","views_Revokevue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/revoke.65895cd5.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Header',{attrs:{\"title\":\"Revoke (active)\"}}),_c('div',{staticClass:\"p-4 after-header\"},[_c('div',{staticClass:\"container-sm mx-auto\"},[(_vm.hasAuthority && _vm.isWeb && !_vm.failed && !_vm.transactionId)?_c('OpenExternal',{staticClass:\"hide-sm\",attrs:{\"uri\":_vm.uri}}):_vm._e(),(_vm.hasAuthority && !_vm.failed && !_vm.transactionId)?_c('form',{staticClass:\"mb-4\",on:{\"submit\":function($event){$event.preventDefault();return _vm.handleSubmit($event)}}},[_c('div',{staticClass:\"mb-4\"},[(_vm.username)?_c('div',{staticClass:\"mb-4 text-center\"},[_c('Avatar',{attrs:{\"username\":_vm.username,\"size\":80}}),_c('h4',{staticClass:\"mb-0 mt-2\"},[_vm._v(_vm._s(_vm.username))])],1):_vm._e(),_c('p',[_vm._v(\"\\n            Do you want to update your account to revoke \"),_c('b',[_vm._v(_vm._s(_vm.username))]),_vm._v(\" to do\\n            \"),_c('b',[_vm._v(_vm._s(_vm.authority))]),_vm._v(\" operations on your behalf?\\n          \")]),(_vm.account.name && _vm.hasRequiredKey === false)?_c('div',{staticClass:\"flash flash-warn mt-4\"},[_vm._v(\"\\n            This transaction requires your \"),_c('b',[_vm._v(\"active\")]),_vm._v(\" key.\\n          \")]):_vm._e()]),_c('div',{staticClass:\"mt-2\"},[(!_vm.account.name || _vm.hasRequiredKey === false)?_c('router-link',{staticClass:\"btn btn-large btn-blue mr-2 mb-2\",attrs:{\"to\":{\n              name: 'login',\n              query: { redirect: this.$route.fullPath, authority: 'active' },\n            }}},[_vm._v(\"\\n            Continue\\n          \")]):_c('button',{staticClass:\"btn btn-large btn-success mb-2 mr-2\",attrs:{\"type\":\"submit\",\"disabled\":_vm.loading}},[_vm._v(\"\\n            Revoke\\n          \")]),_c('button',{staticClass:\"btn btn-large mb-2\",on:{\"click\":_vm.handleReject}},[_vm._v(\"\\n            Cancel\\n          \")])],1)]):_vm._e(),(!_vm.hasAuthority && !_vm.failed && !_vm.transactionId)?_c('div',[_c('p',{staticClass:\"mb-4\"},[_vm._v(\"\\n          You already revoked the account \"),_c('b',[_vm._v(_vm._s(_vm.username))]),_vm._v(\" to do\\n          \"),_c('b',[_vm._v(_vm._s(_vm.authority))]),_vm._v(\" operations on your behalf.\\n        \")]),(_vm.callback)?[(_vm.callback[0] === '/')?_c('router-link',{staticClass:\"btn btn-large btn-blue mb-2 mt-2\",attrs:{\"to\":_vm.callback}},[_vm._v(\"\\n            Continue\\n          \")]):_c('a',{staticClass:\"btn btn-large btn-blue mb-2 mt-2\",attrs:{\"href\":_vm.callback}},[_vm._v(\"\\n            Continue to \"+_vm._s(_vm._f(\"parseUrl\")(_vm.callback))+\"\\n          \")])]:_vm._e()],2):_vm._e(),(!_vm.loading && _vm.failed)?_c('Error',{attrs:{\"error\":_vm.error}}):_vm._e(),(!_vm.loading && !!_vm.transactionId)?_c('Confirmation',{attrs:{\"id\":_vm.transactionId}}):_vm._e()],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <Header title=\"Revoke (active)\" />\n    <div class=\"p-4 after-header\">\n      <div class=\"container-sm mx-auto\">\n        <OpenExternal\n          v-if=\"hasAuthority && isWeb && !failed && !transactionId\"\n          :uri=\"uri\"\n          class=\"hide-sm\"\n        />\n        <form\n          v-if=\"hasAuthority && !failed && !transactionId\"\n          @submit.prevent=\"handleSubmit\"\n          class=\"mb-4\"\n        >\n          <div class=\"mb-4\">\n            <div class=\"mb-4 text-center\" v-if=\"username\">\n              <Avatar :username=\"username\" :size=\"80\" />\n              <h4 class=\"mb-0 mt-2\">{{ username }}</h4>\n            </div>\n            <p>\n              Do you want to update your account to revoke <b>{{ username }}</b> to do\n              <b>{{ authority }}</b> operations on your behalf?\n            </p>\n            <div class=\"flash flash-warn mt-4\" v-if=\"account.name && hasRequiredKey === false\">\n              This transaction requires your <b>active</b> key.\n            </div>\n          </div>\n          <div class=\"mt-2\">\n            <router-link\n              :to=\"{\n                name: 'login',\n                query: { redirect: this.$route.fullPath, authority: 'active' },\n              }\"\n              class=\"btn btn-large btn-blue mr-2 mb-2\"\n              v-if=\"!account.name || hasRequiredKey === false\"\n            >\n              Continue\n            </router-link>\n            <button\n              type=\"submit\"\n              class=\"btn btn-large btn-success mb-2 mr-2\"\n              :disabled=\"loading\"\n              v-else\n            >\n              Revoke\n            </button>\n            <button class=\"btn btn-large mb-2\" @click=\"handleReject\">\n              Cancel\n            </button>\n          </div>\n        </form>\n        <div v-if=\"!hasAuthority && !failed && !transactionId\">\n          <p class=\"mb-4\">\n            You already revoked the account <b>{{ username }}</b> to do\n            <b>{{ authority }}</b> operations on your behalf.\n          </p>\n          <template v-if=\"callback\">\n            <router-link\n              v-if=\"callback[0] === '/'\"\n              :to=\"callback\"\n              class=\"btn btn-large btn-blue mb-2 mt-2\"\n            >\n              Continue\n            </router-link>\n            <a v-else :href=\"callback\" class=\"btn btn-large btn-blue mb-2 mt-2\">\n              Continue to {{ callback | parseUrl }}\n            </a>\n          </template>\n        </div>\n        <Error v-if=\"!loading && failed\" :error=\"error\" />\n        <Confirmation v-if=\"!loading && !!transactionId\" :id=\"transactionId\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapActions } from 'vuex';\nimport { isWeb, buildSearchParams } from '@/helpers/utils';\nimport { getAuthority } from '@/helpers/auth';\n\nexport default {\n  data() {\n    return {\n      loading: false,\n      failed: false,\n      error: false,\n      transactionId: '',\n      isWeb: isWeb(),\n      username: this.$route.params.username,\n      authority: getAuthority(this.$route.query.authority, 'posting'),\n      callback: this.$route.query.redirect_uri,\n      uri: `steem://revoke/${this.$route.params.username}${buildSearchParams(this.$route)}`,\n    };\n  },\n  computed: {\n    account() {\n      return this.$store.state.auth.account;\n    },\n    hasAuthority() {\n      if (this.account.name) {\n        const auths = this.account[this.authority].account_auths.map(auth => auth[0]);\n        return auths.indexOf(this.username) !== -1;\n      }\n      return true;\n    },\n    hasRequiredKey() {\n      return !!(this.$store.state.auth.username && this.$store.state.auth.keys.active);\n    },\n  },\n  methods: {\n    ...mapActions(['updateAccount', 'loadAccount']),\n    handleSubmit() {\n      const { username, authority, callback, account } = this;\n      this.loading = true;\n      const data = {\n        account: account.name,\n        memo_key: account.memo_key,\n        json_metadata: account.json_metadata,\n      };\n      data[authority] = JSON.parse(JSON.stringify(account[authority]));\n      data[authority].account_auths.forEach((accountAuth, i) => {\n        if (accountAuth[0] === username) data[authority].account_auths.splice(i, 1);\n      });\n\n      this.updateAccount(data)\n        .then(confirmation => {\n          this.loadAccount().then(() => {\n            if (isWeb && callback) {\n              if (callback[0] === '/') {\n                this.$router.push(callback);\n              } else {\n                window.location = callback;\n              }\n            } else {\n              this.transactionId = confirmation.id;\n              this.failed = false;\n              this.loading = false;\n            }\n          });\n        })\n        .catch(err => {\n          this.error = err;\n          console.error('Failed to broadcast transaction', err);\n          this.failed = true;\n          this.loading = false;\n        });\n    },\n    handleReject() {\n      this.$router.push('/');\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Revoke.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Revoke.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Revoke.vue?vue&type=template&id=827795f8&\"\nimport script from \"./Revoke.vue?vue&type=script&lang=js&\"\nexport * from \"./Revoke.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}